import{j as e}from"./index-CS3KqmWJ.js";import{r as t}from"./vendor-react-BJYbxeCs.js";import{a as s}from"./vendor-utils-qHW_S61q.js";import{t as a,a9 as i,z as n,X as r}from"./vendor-ui-Cf-65S3f.js";const l=()=>{const[l,o]=t.useState([]),[c,d]=t.useState(0),[m,x]=t.useState(!0),[h,f]=t.useState(null),[g,u]=t.useState(0),[p,b]=t.useState("right"),[y,j]=t.useState("activities"),v=e=>{if(!e)return[];let t=[];if(Array.isArray(e.images))t=e.images;else if("string"==typeof e.images)try{const s=JSON.parse(e.images);Array.isArray(s)&&(t=s)}catch{}if(t=(t||[]).filter(Boolean),0===t.length&&e.image_path){return[e.image_path.startsWith("data:")?e.image_path:`https://msu-snd-rgms-1.onrender.com${e.image_path.replace(/\\/g,"/")}`]}return t.map(e=>e.startsWith("data:")||e.startsWith("http")?e:`https://msu-snd-rgms-1.onrender.com${String(e).replace(/\\/g,"/")}`)};t.useEffect(()=>{h&&(u(0),b("right"))},[h]),t.useEffect(()=>{(async()=>{try{const e=await s.get("/api/cadet/activities");o(e.data||[])}catch(e){}finally{x(!1)}})()},[]);const N=l.filter(e=>{const t=(e.type||"activity").toLowerCase();return"activities"===y?"activity"===t:"announcement"===t}),w=N&&N.length>0;return t.useEffect(()=>{if(!w)return;const e=setInterval(()=>{d(e=>(e+1)%N.length)},15e3);return()=>clearInterval(e)},[w,N.length]),m?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-green-700"})}):e.jsxs("div",{className:"space-y-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Home"}),e.jsx("p",{className:"text-gray-600",children:"Welcome, Training Staff! All ROTC activities and announcements will appear here."}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 border-b pb-2",children:"Activities & Announcements"}),e.jsxs("div",{className:"flex border-b mb-4",children:[e.jsx("button",{className:"py-2 px-4 font-bold "+("activities"===y?"text-green-700 border-b-2 border-green-700":"text-gray-500 hover:text-green-600"),onClick:()=>{j("activities"),d(0)},children:"Activities"}),e.jsx("button",{className:"py-2 px-4 font-bold "+("announcements"===y?"text-green-700 border-b-2 border-green-700":"text-gray-500 hover:text-green-600"),onClick:()=>{j("announcements"),d(0)},children:"Announcements"})]}),!w&&e.jsxs("div",{className:"text-center text-gray-500 py-10",children:["No ",y," have been posted yet."]}),w&&e.jsx("div",{className:"relative max-w-4xl mx-auto",children:e.jsx("div",{className:"overflow-hidden rounded-lg shadow cursor-pointer",children:e.jsx("div",{className:"flex transition-transform duration-[2000ms] ease-in-out",style:{transform:`translateX(-${100*c}%)`},children:N.map(t=>e.jsxs("div",{className:"w-full flex-shrink-0 bg-white",onClick:()=>f(t),children:[(()=>{const s=v(t)[0];return s?e.jsx("div",{className:"w-full bg-gray-100 flex justify-center items-center h-[400px]",children:e.jsx("img",{src:s,alt:t.title,className:"max-h-full max-w-full object-contain"})}):null})(),e.jsxs("div",{className:"p-4 bg-gray-50",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:t.title}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center mt-1",children:[e.jsx(a,{size:14,className:"mr-1"}),new Date(t.date).toLocaleDateString()]}),e.jsx("p",{className:"mt-2 text-gray-600 line-clamp-2",children:t.description})]})]},t.id))})})})]}),h&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-90 backdrop-blur-sm",onClick:()=>f(null),children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-y-auto flex flex-col md:flex-row overflow-hidden",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"w-full md:w-2/3 bg-black flex items-center justify-center relative min-h-[300px] md:min-h-[600px] overflow-hidden",children:[e.jsx("style",{children:"\n                                @keyframes slideInRight {\n                                    from { transform: translateX(100%); opacity: 0; }\n                                    to { transform: translateX(0); opacity: 1; }\n                                }\n                                @keyframes slideInLeft {\n                                    from { transform: translateX(-100%); opacity: 0; }\n                                    to { transform: translateX(0); opacity: 1; }\n                                }\n                                .animate-slide-in-right { animation: slideInRight 0.3s ease-out forwards; }\n                                .animate-slide-in-left { animation: slideInLeft 0.3s ease-out forwards; }\n                             "}),(()=>{const t=v(h),s=t.length>0?t[g]:null;return e.jsxs(e.Fragment,{children:[s?e.jsx("img",{src:s,alt:h.title,className:"max-w-full max-h-full object-contain "+("right"===p?"animate-slide-in-right":"animate-slide-in-left")},g):e.jsx("div",{className:"text-gray-500",children:"No image available"}),t.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:e=>{e.stopPropagation(),b("left"),setTimeout(()=>{u(e=>(e-1+t.length)%t.length)},0)},className:"absolute left-4 top-1/2 -translate-y-1/2 bg-white bg-opacity-20 hover:bg-opacity-50 text-white rounded-full p-2 transition-all z-10",children:e.jsx(i,{size:32})}),e.jsx("button",{onClick:e=>{e.stopPropagation(),b("right"),setTimeout(()=>{u(e=>(e+1)%t.length)},0)},className:"absolute right-4 top-1/2 -translate-y-1/2 bg-white bg-opacity-20 hover:bg-opacity-50 text-white rounded-full p-2 transition-all z-10",children:e.jsx(n,{size:32})}),e.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black bg-opacity-50 text-white px-3 py-1 rounded-full text-sm z-10",children:[g+1," / ",t.length]})]})]})})()]}),e.jsxs("div",{className:"w-full md:w-1/3 flex flex-col h-full bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 pr-4 truncate",children:h.title}),e.jsx("button",{onClick:()=>f(null),className:"text-gray-500 hover:text-red-500 transition-colors p-1 rounded-full hover:bg-gray-100",children:e.jsx(r,{size:24})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[e.jsxs("div",{className:"flex items-center text-gray-500 text-sm mb-4 bg-gray-50 p-2 rounded inline-block",children:[e.jsx(a,{size:16,className:"mr-2"}),e.jsx("span",{className:"font-medium",children:h.date})]}),e.jsx("div",{className:"prose max-w-none text-gray-800 whitespace-pre-wrap leading-relaxed",children:h.description})]})]})]})})]})};export{l as default};
