import{j as e,d as t,e as s}from"./index-b5aGx8Xb.js";import{r as a}from"./vendor-react-BJYbxeCs.js";import{a as i}from"./vendor-utils-qHW_S61q.js";import{t as n,a9 as r,z as l,X as o}from"./vendor-ui-Cf-65S3f.js";import{W as c}from"./WeatherAdvisory-CS4_JXSc.js";const d={BASE_URL:"/static/",DEV:!1,MODE:"production",PACKAGE_VERSION:"2.3.23",PROD:!0,SSR:!1,VITE_API_URL:"https://msu-snd-rgms-1.onrender.com",VITE_ENV:"production",VITE_WS_URL:"wss://msu-snd-rgms-1.onrender.com"},m=()=>{const[m,h]=a.useState([]),[x,g]=a.useState(0),[u,p]=a.useState(!0),[f,b]=a.useState(null),[y,j]=a.useState(0),[v,w]=a.useState("right"),[N,k]=a.useState("activities"),S=e=>{if(!e)return[];let t=[];if(Array.isArray(e.images))t=e.images;else if("string"==typeof e.images)try{const s=JSON.parse(e.images);Array.isArray(s)&&(t=s)}catch{}t=(t||[]).filter(Boolean);let s=[i&&i.defaults&&i.defaults.baseURL||"",import.meta&&d?"https://msu-snd-rgms-1.onrender.com":"","undefined"!=typeof window&&window.location?window.location.origin:""].find(e=>e&&/^https?:/.test(String(e)))||"";if(s=String(s).replace(/\/+$/,""),0===t.length&&e.image_path){const t=String(e.image_path).replace(/\\/g,"/");return[e.image_path.startsWith("data:")?e.image_path:`${s}${t.startsWith("/")?"":"/"}${t}`]}return t.map(e=>{if(e.startsWith("data:")||e.startsWith("http"))return e;const t=String(e).replace(/\\/g,"/");return`${s}${t.startsWith("/")?"":"/"}${t}`})};a.useEffect(()=>{f&&(j(0),w("right"))},[f]),a.useEffect(()=>{(async()=>{try{try{const e=await t("activities");(null==e?void 0:e.length)&&h(e)}catch{}const e=await i.get("/api/cadet/activities");h(e.data||[]),await s("activities",e.data||[])}catch(e){}finally{p(!1)}})()},[]);const C=m.filter(e=>{const t=(e.type||"activity").toLowerCase();return"activities"===N?"activity"===t:"announcement"===t}),z=C&&C.length>0;a.useEffect(()=>{if(!z)return;const e=setInterval(()=>{g(e=>(e+1)%C.length)},15e3);return()=>clearInterval(e)},[z,C.length]);return u?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-green-700"})}):e.jsxs("div",{className:"space-y-8",children:[e.jsx(c,{}),e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Home"}),e.jsx("p",{className:"text-gray-600",children:"All ROTC activities and announcements from the administrator will appear here."}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex border-b mb-4",children:[e.jsx("button",{className:"py-2 px-4 font-bold "+("activities"===N?"text-green-700 border-b-2 border-green-700":"text-gray-500 hover:text-green-600"),onClick:()=>{k("activities"),g(0)},children:"Activities"}),e.jsx("button",{className:"py-2 px-4 font-bold "+("announcements"===N?"text-green-700 border-b-2 border-green-700":"text-gray-500 hover:text-green-600"),onClick:()=>{k("announcements"),g(0)},children:"Announcements"})]}),!z&&e.jsxs("div",{className:"text-center text-gray-500 py-10",children:["No ",N," posted yet."]}),z&&e.jsxs("div",{className:"relative max-w-4xl mx-auto",children:[e.jsx("div",{className:"overflow-hidden rounded-lg shadow cursor-pointer",children:e.jsx("div",{className:"flex transition-transform duration-[2000ms] ease-in-out",style:{transform:`translateX(-${100*x}%)`},children:C.map(t=>e.jsxs("div",{className:"w-full flex-shrink-0 bg-white",onClick:()=>b(t),children:[(()=>{const s=S(t)[0];return s?e.jsx("div",{className:"w-full bg-gray-100 flex justify-center items-center h-[400px]",children:e.jsx("img",{src:s,alt:t.title,className:"w-full h-full object-cover"})}):null})(),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center text-gray-500 text-sm mb-2",children:[e.jsx(n,{size:16,className:"mr-2"}),t.date]}),e.jsx("h3",{className:"text-2xl font-bold mb-2",children:t.title}),e.jsx("p",{className:"text-gray-700 whitespace-pre-line line-clamp-3",children:t.description||"No description provided."}),e.jsx("p",{className:"text-blue-600 text-sm mt-2",children:"Click to view details"})]})]},t.id))})}),C.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:e=>{e.stopPropagation(),z&&g(e=>(e-1+C.length)%C.length)},className:"absolute left-0 top-1/2 -translate-y-1/2 bg-white bg-opacity-80 hover:bg-opacity-100 text-gray-700 rounded-full p-2 shadow-md",children:e.jsx(r,{size:20})}),e.jsx("button",{type:"button",onClick:e=>{e.stopPropagation(),z&&g(e=>(e+1)%C.length)},className:"absolute right-0 top-1/2 -translate-y-1/2 bg-white bg-opacity-80 hover:bg-opacity-100 text-gray-700 rounded-full p-2 shadow-md",children:e.jsx(l,{size:20})})]}),C.length>1&&e.jsx("div",{className:"flex justify-center mt-4 space-x-2",children:C.map((t,s)=>e.jsx("button",{type:"button",onClick:()=>g(s),className:"w-3 h-3 rounded-full "+(s===x?"bg-green-700":"bg-gray-300")},t.id))})]})]}),f&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-90 backdrop-blur-sm",onClick:()=>b(null),children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-y-auto flex flex-col md:flex-row overflow-hidden",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"w-full md:w-2/3 bg-black flex items-center justify-center relative min-h-[300px] md:min-h-[600px] overflow-hidden",children:[e.jsx("style",{children:"\n                                @keyframes slideInRight {\n                                    from { transform: translateX(100%); opacity: 0; }\n                                    to { transform: translateX(0); opacity: 1; }\n                                }\n                                @keyframes slideInLeft {\n                                    from { transform: translateX(-100%); opacity: 0; }\n                                    to { transform: translateX(0); opacity: 1; }\n                                }\n                                .animate-slide-in-right { animation: slideInRight 0.3s ease-out forwards; }\n                                .animate-slide-in-left { animation: slideInLeft 0.3s ease-out forwards; }\n                             "}),(()=>{const t=S(f),s=t.length>0?t[y]:null;return e.jsxs(e.Fragment,{children:[s?e.jsx("img",{src:s,alt:f.title,className:"max-w-full max-h-full object-contain "+("right"===v?"animate-slide-in-right":"animate-slide-in-left")},y):e.jsx("div",{className:"text-gray-500",children:"No image available"}),t.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:e=>{e.stopPropagation(),w("left"),setTimeout(()=>{j(e=>(e-1+t.length)%t.length)},0)},className:"absolute left-4 top-1/2 -translate-y-1/2 bg-white bg-opacity-20 hover:bg-opacity-50 text-white rounded-full p-2 transition-all z-10",children:e.jsx(r,{size:32})}),e.jsx("button",{onClick:e=>{e.stopPropagation(),w("right"),setTimeout(()=>{j(e=>(e+1)%t.length)},0)},className:"absolute right-4 top-1/2 -translate-y-1/2 bg-white bg-opacity-20 hover:bg-opacity-50 text-white rounded-full p-2 transition-all z-10",children:e.jsx(l,{size:32})}),e.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black bg-opacity-50 text-white px-3 py-1 rounded-full text-sm z-10",children:[y+1," / ",t.length]})]})]})})()]}),e.jsxs("div",{className:"w-full md:w-1/3 flex flex-col h-full bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 pr-4 truncate",children:f.title}),e.jsx("button",{onClick:()=>b(null),className:"text-gray-500 hover:text-red-500 transition-colors p-1 rounded-full hover:bg-gray-100",children:e.jsx(o,{size:24})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[e.jsxs("div",{className:"flex items-center text-gray-500 text-sm mb-4 bg-gray-50 p-2 rounded inline-block",children:[e.jsx(n,{size:16,className:"mr-2"}),e.jsx("span",{className:"font-medium",children:f.date})]}),e.jsx("div",{className:"prose max-w-none text-gray-800 whitespace-pre-wrap leading-relaxed",children:f.description})]})]})]})})]})};export{m as default};
