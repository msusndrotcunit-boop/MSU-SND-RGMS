import{u as e,j as a}from"./index-CS3KqmWJ.js";import{u as s,r as t}from"./vendor-react-BJYbxeCs.js";import{a as i}from"./vendor-utils-qHW_S61q.js";import{a7 as n,T as d}from"./vendor-ui-Cf-65S3f.js";const l=()=>{const{user:l}=e(),r=s(),[c,o]=t.useState([]),[m,x]=t.useState(!0),[f,u]=t.useState(null),h=((null==l?void 0:l.role)||"").toLowerCase(),p="admin"===h?"/api/admin/notifications":"training_staff"===h?"/api/staff/notifications":"/api/cadet/notifications",j="admin"===h?"/api/admin/notifications":"training_staff"===h?"/api/staff/notifications/delete-all":"/api/cadet/notifications/delete-all",g=async()=>{var e,a;x(!0),u(null);try{const e=await i.get(p),a=(e.data||[]||[]).filter(e=>null===e.user_id);o(a)}catch(s){u((null==(a=null==(e=s.response)?void 0:e.data)?void 0:a.message)||"Failed to load broadcasts")}finally{x(!1)}};t.useEffect(()=>{g()},[]);const b="admin"===h?"Admin Broadcasts":"training_staff"===h?"Unit Broadcasts":"Announcements",v="admin"===h?"/admin/dashboard":"training_staff"===h?"/staff/dashboard":"/cadet/dashboard";return m?a.jsx("div",{className:"p-6",children:"Loading..."}):f?a.jsxs("div",{className:"p-6",children:[a.jsx("div",{className:"text-red-600 mb-3",children:f}),a.jsxs("button",{onClick:g,className:"inline-flex items-center px-3 py-2 bg-blue-600 text-white rounded",children:[a.jsx(n,{size:16,className:"mr-2"})," Retry"]})]}):a.jsxs("div",{className:"max-w-4xl mx-auto p-4 md:p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h1",{className:"text-2xl font-bold",children:b}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:async()=>{try{await i.delete(j),o([])}catch{}},className:"px-3 py-2 bg-red-600 text-white rounded inline-flex items-center",children:[a.jsx(d,{size:16,className:"mr-2"})," Clear All"]}),a.jsx("button",{onClick:()=>r(v),className:"px-3 py-2 bg-gray-200 rounded",children:"Back"})]})]}),0===c.length?a.jsx("div",{className:"p-6 bg-white rounded shadow text-gray-600",children:"No broadcast messages"}):a.jsx("div",{className:"space-y-3",children:c.map(e=>a.jsxs("div",{className:"bg-white rounded shadow p-4 flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:e.message}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:new Date(e.created_at).toLocaleString()})]}),a.jsx("button",{onClick:()=>(async e=>{try{await i.delete(`/api/notifications/${e}`),o(a=>a.filter(a=>a.id!==e))}catch{}})(e.id),className:"text-gray-500 hover:text-red-600",children:a.jsx(d,{size:18})})]},e.id))})]})};export{l as default};
