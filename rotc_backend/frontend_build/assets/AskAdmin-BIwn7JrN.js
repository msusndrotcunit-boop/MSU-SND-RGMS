import{j as e}from"./index-Df_F6O4f.js";import{r as s}from"./vendor-react-BJYbxeCs.js";import{a,c as t}from"./vendor-utils-qHW_S61q.js";import{n as r,w as l,K as i,N as o,am as d}from"./vendor-ui-Cf-65S3f.js";import{M as n,F as c,b as m,a as g,c as x,d as u}from"./MobileFormLayout-BSubePT0.js";import"./useResponsive-XC39aU2L.js";const h=({formData:s,onChange:a,onSubmit:t,loading:r=!1,title:l="Contact Form",showSubject:i=!0,showCategory:o=!1,categories:d=[]})=>{const h=e=>t=>{a({...s,[e]:t.target.value})};return e.jsxs(n,{onSubmit:t,children:[o&&d.length>0&&e.jsx(c,{label:"Category",required:!0,children:e.jsx(m,{value:s.category||"",onChange:h("category"),options:d,placeholder:"Select a category",required:!0})}),i&&e.jsx(c,{label:"Subject",required:!0,children:e.jsx(g,{type:"text",value:s.subject||"",onChange:h("subject"),placeholder:"Enter subject",disabled:r,required:!0})}),e.jsx(c,{label:"Message",required:!0,children:e.jsx(x,{value:s.message||"",onChange:h("message"),placeholder:"Enter your message",rows:6,disabled:r,autoResize:!0,required:!0})}),e.jsx(u,{alignment:"right",children:e.jsx("button",{type:"submit",disabled:r,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-semibold py-3 px-6 rounded-lg transition-colors touch-target",children:r?"Sending...":"Send Message"})})]})},b=()=>{const[n,c]=s.useState([]),[m,g]=s.useState({subject:"",message:""}),[x,u]=s.useState(!1),[b,j]=s.useState(!1);s.useEffect(()=>{p()},[]);const p=async()=>{try{u(!0);const e=await a.get("/api/messages/my");c(e.data)}catch(e){r.error("Failed to load messages")}finally{u(!1)}};return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 p-4",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(l,{className:"text-blue-600"}),"Ask the Admin"]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 md:p-6 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 dark:text-gray-100",children:"Submit a Report or Question"}),e.jsx(h,{formData:m,onChange:g,onSubmit:async e=>{if(e.preventDefault(),m.subject.trim()&&m.message.trim())try{j(!0),await a.post("/api/messages",{subject:m.subject,message:m.message}),r.success("Message sent successfully"),g({subject:"",message:""}),p()}catch(s){r.error("Failed to send message")}finally{j(!1)}},loading:b,showSubject:!0,showCategory:!1})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"My Messages"}),x?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):0===n.length?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(i,{className:"mx-auto mb-2 opacity-50",size:32}),"No messages yet."]}):e.jsx("div",{className:"space-y-4",children:n.map(s=>{return e.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-sm transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.subject}),e.jsxs("div",{className:"flex items-center gap-1 text-sm font-medium",children:[(a=s.status,"resolved"===a?e.jsx(o,{className:"text-green-500",size:20}):e.jsx(d,{className:"text-yellow-500",size:20})),e.jsx("span",{className:t("resolved"===s.status?"text-green-600":"text-yellow-600"),children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})]})]}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap mb-3",children:s.message}),e.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:["Sent on ",new Date(s.created_at).toLocaleDateString()," at ",new Date(s.created_at).toLocaleTimeString()]}),s.admin_reply&&e.jsxs("div",{className:"bg-gray-50 border-l-4 border-blue-500 p-3 mt-3 rounded-r",children:[e.jsx("p",{className:"text-sm font-semibold text-blue-800 mb-1",children:"Admin Reply:"}),e.jsx("p",{className:"text-gray-800 whitespace-pre-wrap",children:s.admin_reply})]})]},s.id);var a})})]})]})};export{b as default};
