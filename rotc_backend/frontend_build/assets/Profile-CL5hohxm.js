import{u as e,g as s,c as a,j as t}from"./index-Df_F6O4f.js";import{r,b as l}from"./vendor-react-BJYbxeCs.js";import{a as i}from"./vendor-utils-qHW_S61q.js";import{a as n}from"./image-CT_PXJmf.js";import{ag as c,a as d,o,S as m,av as x}from"./vendor-ui-Cf-65S3f.js";const u=()=>{const{user:u}=e(),[p,g]=r.useState(null),[h,b]=r.useState(!0),[f,j]=r.useState(null),[y,v]=r.useState(null),[N,w]=r.useState(null),[k,C]=r.useState(!1),A=l.useRef(null);r.useEffect(()=>{S()},[]);const S=async()=>{var e,t;b(!0),j(null);try{try{const e=await s("profiles","admin");if(e){g(e);const s=n(e.profile_pic,null==u?void 0:u.id,"admin");w(s)}}catch{}const e=await i.get("/api/admin/profile");g(e.data);const t=n(e.data.profile_pic,null==u?void 0:u.id,"admin");w(t),await a("profiles","admin",e.data)}catch(r){j((null==(t=null==(e=r.response)?void 0:e.data)?void 0:t.message)||"Failed to load profile.")}finally{b(!1)}};return h?t.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading profile..."}):f?t.jsx("div",{className:"p-8 text-center text-red-500",children:f}):p?t.jsxs("div",{className:"max-w-5xl mx-auto space-y-6",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"My Profile"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsx("div",{className:"md:col-span-1",children:t.jsxs("div",{className:"bg-white rounded shadow p-6 flex flex-col items-center h-full",children:[t.jsxs("div",{className:"relative w-40 h-40 mb-6",children:[t.jsx("img",{src:N,alt:"Profile",className:"w-full h-full object-cover rounded-full border-4 border-gray-200 shadow-sm",onError:e=>{e.target.src="/api/admin/profile/image"}}),t.jsxs("label",{className:"absolute bottom-1 right-1 bg-blue-600 text-white p-2 rounded-full cursor-pointer hover:bg-blue-700 shadow-md transition-colors",onClick:e=>{e.preventDefault(),C(!0)},children:[t.jsx(c,{size:20}),t.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:e=>{const s=e.target.files[0];v(s),s&&w(URL.createObjectURL(s))},ref:A})]})]}),y&&t.jsx("button",{onClick:async()=>{if(!y)return;const e=new FormData;e.append("profilePic",y),(null==p?void 0:p.gender)&&e.append("gender",p.gender);try{await i.put("/api/admin/profile",e,{headers:{"Content-Type":"multipart/form-data"}}),alert("Profile picture updated!"),S(),v(null)}catch(s){alert("Failed to update profile.")}},className:"w-full bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition mb-2 font-medium",children:"Save New Picture"}),t.jsx("p",{className:"text-sm text-gray-500 text-center mt-2",children:"Click the camera icon to update your profile photo."})]})}),t.jsx("div",{className:"md:col-span-2",children:t.jsxs("div",{className:"bg-white rounded shadow p-6 h-full",children:[t.jsxs("h3",{className:"text-lg font-bold mb-6 flex items-center text-gray-800 border-b pb-2",children:[t.jsx(d,{className:"mr-2 text-blue-600",size:20})," Account Information"]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mb-1 block",children:"Username"}),t.jsxs("div",{className:"flex items-center text-gray-800 bg-gray-50 p-3 rounded border border-gray-100",children:[t.jsx(d,{size:18,className:"mr-3 text-gray-400"}),t.jsx("span",{className:"font-medium",children:p.username})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mb-1 block",children:"Email Address"}),t.jsxs("div",{className:"flex items-center text-gray-800 bg-gray-50 p-3 rounded border border-gray-100",children:[t.jsx(o,{size:18,className:"mr-3 text-gray-400"}),t.jsx("span",{className:"font-medium",children:p.email||"No email provided"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase font-bold tracking-wider mb-1 block",children:"Account Role"}),t.jsxs("div",{className:"flex items-center text-gray-800 bg-gray-50 p-3 rounded border border-gray-100",children:[t.jsx(m,{size:18,className:"mr-3 text-gray-400"}),t.jsx("span",{className:"font-medium capitalize",children:"Administrator"})]})]})]})]})})]}),t.jsxs("div",{className:"bg-white rounded shadow p-6",children:[t.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center text-gray-800 border-b pb-2",children:[t.jsx(x,{className:"mr-2 text-blue-600",size:20})," About the App"]}),t.jsxs("div",{className:"prose max-w-none text-gray-600",children:[t.jsxs("p",{className:"mb-4",children:["The ",t.jsx("strong",{children:"ROTC Grading Management System"})," is a comprehensive platform designed to streamline the administrative and operational tasks of the ROTC unit. It facilitates efficient management of cadet records, grading, attendance tracking, and performance evaluation."]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-6 bg-gray-50 p-4 rounded border border-gray-100",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500 uppercase font-bold block mb-1",children:"System Name"}),t.jsx("span",{className:"font-semibold text-gray-800",children:"ROTC Grading Management System"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500 uppercase font-bold block mb-1",children:"Version"}),t.jsx("span",{className:"font-semibold text-gray-800",children:"2.3.23"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500 uppercase font-bold block mb-1",children:"Developer"}),t.jsx("span",{className:"font-semibold text-gray-800",children:"MSU-SND ROTC Unit"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500 uppercase font-bold block mb-1",children:"Release Date"}),t.jsx("span",{className:"font-semibold text-gray-800",children:"January 2026"})]})]}),t.jsxs("div",{className:"mt-6",children:[t.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Key Features"}),t.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[t.jsx("li",{children:"Comprehensive Cadet Profiling & Management"}),t.jsx("li",{children:"Automated Grading & Transmutation System"}),t.jsx("li",{children:"Activity & Attendance Tracking"}),t.jsx("li",{children:"Secure Admin & Cadet Portals"}),t.jsx("li",{children:"User Approval & Access Control"})]})]})]})]}),k&&t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[t.jsx("h4",{className:"text-lg font-bold text-gray-800 mb-2",children:"Allow Camera or Files Access"}),t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"To update your profile photo, choose whether to use your camera or select from your gallery/files."}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{type:"button",onClick:()=>C(!1),className:"px-4 py-2 text-sm rounded border border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{type:"button",onClick:async()=>{var e,s,a,t;try{if(null==(e=navigator.mediaDevices)?void 0:e.getUserMedia){const e=await navigator.mediaDevices.getUserMedia({video:!0});try{e.getTracks().forEach(e=>e.stop())}catch{}}}catch{}try{null==(s=A.current)||s.setAttribute("accept","image/*"),null==(a=A.current)||a.setAttribute("capture","environment"),null==(t=A.current)||t.click()}catch{}C(!1)},className:"px-4 py-2 text-sm rounded bg-blue-600 text-white hover:bg-blue-700",children:"Use Camera"}),t.jsx("button",{type:"button",onClick:()=>{var e,s,a;try{null==(e=A.current)||e.setAttribute("accept","image/*"),null==(s=A.current)||s.removeAttribute("capture"),null==(a=A.current)||a.click()}catch{}C(!1)},className:"px-4 py-2 text-sm rounded bg-green-700 text-white hover:bg-green-800",children:"Choose Files"})]})]})})]}):t.jsx("div",{className:"p-8 text-center text-red-500",children:"Profile not found."})};export{u as default};
