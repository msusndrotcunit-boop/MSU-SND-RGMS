import{a as e,j as a}from"./index-CxXeNUtR.js";import{r as t}from"./vendor-react-BJYbxeCs.js";import{a as s}from"./vendor-utils-qHW_S61q.js";import{P as r,g as l,h as d,i,D as n,T as c,j as o,n as x}from"./vendor-ui-Cf-65S3f.js";const m=()=>{const{settings:r,setSettings:l}=e(),[d,i]=t.useState(!1),[n,c]=t.useState("");return a.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Custom Background"}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Upload a custom background image for your dashboard."}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("label",{className:"block",children:[a.jsx("span",{className:"sr-only",children:"Choose profile photo"}),a.jsx("input",{type:"file",accept:"image/*",onChange:async e=>{const a=e.target.files[0];if(!a)return;const t=new FormData;t.append("image",a),i(!0),c("");try{const e=localStorage.getItem("token");await s.post("/api/auth/settings/background",t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${e}`}});window.location.reload()}catch(r){c("Upload failed")}finally{i(!1)}},disabled:d,className:"block w-full text-sm text-gray-500 dark:text-gray-400\r\n                                file:mr-4 file:py-2 file:px-4\r\n                                file:rounded-full file:border-0\r\n                                file:text-sm file:font-semibold\r\n                                file:bg-primary-50 file:text-primary-700\r\n                                hover:file:bg-primary-100\r\n                                dark:file:bg-gray-700 dark:file:text-gray-300\r\n                            "})]}),d&&a.jsx("span",{className:"text-sm text-blue-500",children:"Uploading..."})]}),r.theme.customBg&&a.jsxs("div",{className:"mt-4",children:[a.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Current Background:"}),a.jsx("img",{src:r.theme.customBg,alt:"Current Background",className:"w-32 h-20 object-cover rounded-md border border-gray-300 dark:border-gray-600"}),a.jsx("button",{onClick:async()=>{try{const e=localStorage.getItem("token");await s.put("/api/auth/settings",{...r,custom_bg:null},{headers:{Authorization:`Bearer ${e}`}}),window.location.reload()}catch(e){}},className:"mt-2 text-xs text-red-500 hover:text-red-600 underline",children:"Remove Background"})]}),n&&a.jsx("p",{className:"text-sm text-red-500",children:n})]})]})},g=({role:g})=>{var p,h,u,y,b,f,j,k,v,N;const{settings:w,updateSettings:C}=e(),[S,A]=t.useState(w),[$,z]=t.useState(!1),[B,E]=t.useState(null),[M,U]=t.useState(!1);t.useEffect(()=>{A(w)},[w]),t.useEffect(()=>{let e=!0;const a=async()=>{if("admin"===g)try{const a=await s.get("/api/admin/system-status");if(!e)return;E(a.data||null),U(!1)}catch(a){if(!e)return;U(!0)}};a();const t=setInterval(a,6e4);return()=>{e=!1,clearInterval(t)}},[g]);const D=(e,a,t)=>{A(s=>({...s,[e]:{...s[e],[a]:t}}))};return a.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white dark:bg-gray-900 rounded-lg shadow-md",children:[a.jsxs("h2",{className:"text-2xl font-bold mb-6 text-gray-800 dark:text-gray-100 flex items-center gap-2",children:[a.jsx(r,{className:"text-[var(--primary-color)]"}),"My Settings"]}),a.jsxs("div",{className:"space-y-8",children:[a.jsxs("section",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-100 flex items-center gap-2",children:[a.jsx(l,{size:20}),"Notifications"]}),a.jsxs("div",{className:"space-y-3 pl-4 border-l-2 border-gray-100 dark:border-gray-700",children:[a.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:S.notifications.emailAlerts,onChange:e=>D("notifications","emailAlerts",e.target.checked),className:"form-checkbox h-3 w-3 text-[var(--primary-color)] rounded focus:ring-[var(--primary-color)]"}),a.jsx("span",{className:"text-gray-700",children:"Email Alerts"})]}),a.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:S.notifications.pushNotifications,onChange:e=>D("notifications","pushNotifications",e.target.checked),className:"form-checkbox h-3 w-3 text-blue-600 rounded focus:ring-blue-500"}),a.jsx("span",{className:"text-gray-700",children:"Push Notifications"})]}),a.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:S.notifications.activityUpdates,onChange:e=>D("notifications","activityUpdates",e.target.checked),className:"form-checkbox h-3 w-3 text-blue-600 rounded focus:ring-blue-500"}),a.jsx("span",{className:"text-gray-700",children:"Activity Updates"})]})]})]}),a.jsxs("section",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-100 flex items-center gap-2",children:[a.jsx(d,{size:20}),"Display"]}),a.jsxs("div",{className:"space-y-3 pl-4 border-l-2 border-gray-100 dark:border-gray-700",children:[a.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:S.display.darkMode,onChange:e=>D("display","darkMode",e.target.checked),className:"form-checkbox h-3 w-3 text-[var(--primary-color)] rounded focus:ring-[var(--primary-color)]"}),a.jsx("span",{className:"text-gray-700",children:"Dark Mode (Beta)"})]}),a.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:S.display.compactMode,onChange:e=>D("display","compactMode",e.target.checked),className:"form-checkbox h-3 w-3 text-[var(--primary-color)] rounded focus:ring-[var(--primary-color)]"}),a.jsx("span",{className:"text-gray-700",children:"Compact Mode"})]})]})]}),a.jsxs("section",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-100 flex items-center gap-2",children:[a.jsx(r,{size:20}),"Theme Customization"]}),a.jsxs("div",{className:"pl-4 border-l-2 border-gray-100 dark:border-gray-700 space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Primary Color"}),a.jsxs("label",{className:"flex items-center gap-2 mb-2 text-xs text-gray-600 dark:text-gray-400",children:[a.jsx("input",{type:"checkbox",checked:!!(null==(p=S.display)?void 0:p.compactSwatches),onChange:e=>A(a=>({...a,display:{...a.display,compactSwatches:e.target.checked}})),className:"form-checkbox h-3 w-3 text-[var(--primary-color)] rounded focus:ring-[var(--primary-color)]"}),"Compact swatches"]}),a.jsx("div",{className:"flex gap-3 flex-wrap",children:["default","blue","indigo","green","emerald","red","pink","purple","orange","amber","cyan","teal","slate","gradient-emerald","gradient-sunset","gradient-ocean"].map(e=>{var t;const s=e.startsWith("gradient-"),r=s?e.replace("gradient-","").replace("-"," ")+" gradient":"default"===e?"Default":e;return a.jsx("button",{onClick:()=>D("theme","primaryColor",e),className:`${(null==(t=S.display)?void 0:t.compactSwatches)?"w-6 h-6":"w-8 h-8"} rounded-full border-2 transition-transform ${S.theme.primaryColor===e?"border-gray-900 scale-110":"border-gray-200 hover:scale-105"}`,style:s?{backgroundImage:"var(--primary-gradient)",background:"gradient-emerald"===e?"linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%)":"gradient-sunset"===e?"linear-gradient(135deg, #fb7185 0%, #f59e0b 50%, #ea580c 100%)":"linear-gradient(135deg, #06b6d4 0%, #3b82f6 50%, #1d4ed8 100%)"}:{backgroundColor:{default:"#0f766e",blue:"#2563eb",indigo:"#4f46e5",green:"#16a34a",emerald:"#059669",red:"#dc2626",pink:"#db2777",purple:"#7c3aed",orange:"#ea580c",amber:"#d97706",cyan:"#06b6d4",teal:"#0f766e",slate:"#334155"}[e]},"aria-label":r,title:r},e)})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"text-xs font-semibold uppercase text-gray-500",children:"Solids"}),a.jsx("div",{className:"flex gap-3 flex-wrap",children:["default","blue","indigo","green","emerald","red","pink","purple","orange","amber","cyan","teal","slate"].map(e=>{var t;return a.jsx("button",{onClick:()=>D("theme","primaryColor",e),className:`${(null==(t=S.display)?void 0:t.compactSwatches)?"w-6 h-6":"w-8 h-8"} rounded-full border-2 ${S.theme.primaryColor===e?"border-gray-900 scale-110":"border-gray-200 hover:scale-105"} transition-transform`,style:{backgroundColor:{default:"#0f766e",blue:"#2563eb",indigo:"#4f46e5",green:"#16a34a",emerald:"#059669",red:"#dc2626",pink:"#db2777",purple:"#7c3aed",orange:"#ea580c",amber:"#d97706",cyan:"#06b6d4",teal:"#0f766e",slate:"#334155"}[e]},title:e},`solid-${e}`)})}),a.jsx("div",{className:"text-xs font-semibold uppercase text-gray-500",children:"Gradients"}),a.jsx("div",{className:"flex gap-3 flex-wrap",children:["gradient-emerald","gradient-sunset","gradient-ocean"].map(e=>{var t;return a.jsx("button",{onClick:()=>D("theme","primaryColor",e),className:`${(null==(t=S.display)?void 0:t.compactSwatches)?"w-6 h-6":"w-8 h-8"} rounded-full border-2 ${S.theme.primaryColor===e?"border-gray-900 scale-110":"border-gray-200 hover:scale-105"} transition-transform`,style:{background:{"gradient-emerald":"linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%)","gradient-sunset":"linear-gradient(135deg, #fb7185 0%, #f59e0b 50%, #ea580c 100%)","gradient-ocean":"linear-gradient(135deg, #06b6d4 0%, #3b82f6 50%, #1d4ed8 100%)"}[e]},title:e.replace("gradient-","")+" gradient"},`grad-${e}`)})}),a.jsx("div",{className:"text-xs font-semibold uppercase text-gray-500",children:"Unit Packages"}),a.jsx("div",{className:"flex gap-3 flex-wrap",children:[{token:"default",name:"ROTC Green"},{token:"slate",name:"Ops Slate"},{token:"gradient-emerald",name:"Field Blend"}].map(e=>{var t;return a.jsx("button",{onClick:()=>D("theme","primaryColor",e.token),className:`${(null==(t=S.display)?void 0:t.compactSwatches)?"px-2 py-1 text-xs":"px-3 py-1.5 text-sm"} rounded border-2 ${S.theme.primaryColor===e.token?"border-gray-900":"border-gray-200"} bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100 hover:shadow`,title:e.name,children:e.name},`pkg-${e.token}`)})})]}),a.jsx("div",{children:a.jsx(m,{})})]})]}),"admin"===g&&a.jsxs("section",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 text-gray-700 flex items-center gap-2",children:[a.jsx(i,{size:20}),"Archive & Maintenance"]}),a.jsx("div",{className:"space-y-4 pl-4 border-l-2 border-gray-100",children:a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:[a.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Old Graduates Management"}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:'Export data of cadets who have completed the course (Status: "Completed"), then remove them to free up database space.'}),a.jsxs("div",{className:"flex gap-3 flex-wrap",children:[a.jsxs("button",{onClick:async()=>{try{const e=await s.get("/api/admin/cadets/export-completed",{responseType:"blob",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),a=window.URL.createObjectURL(new Blob([e.data])),t=document.createElement("a");t.href=a,t.setAttribute("download","Graduates_Archive.xlsx"),document.body.appendChild(t),t.click(),t.remove(),x.success("Graduates list exported successfully.")}catch(e){e.response&&404===e.response.status?x.error("No completed cadets found to export."):x.error("Failed to export graduates.")}},className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition-colors",children:[a.jsx(n,{size:16}),"Export Graduates (Excel)"]}),a.jsxs("button",{onClick:async()=>{var e,a;if(window.confirm('WARNING: This will PERMANENTLY DELETE all cadets with status "Completed" from the database.\n\nMake sure you have exported/downloaded their data first.\n\nAre you sure you want to proceed?'))try{const e=await s.delete("/api/admin/cadets/prune-completed",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});x.success(e.data.message)}catch(t){x.error("Failed to delete graduates: "+((null==(a=null==(e=t.response)?void 0:e.data)?void 0:a.message)||t.message))}},className:"flex items-center gap-2 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition-colors",children:[a.jsx(c,{size:16}),"Delete from Database"]})]})]})})]}),"admin"===g&&a.jsxs("section",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-100 flex items-center gap-2",children:[a.jsx(i,{size:20}),"Database Status"]}),a.jsx("div",{className:"space-y-4 pl-4 border-l-2 border-gray-100 dark:border-gray-700",children:a.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Type"}),a.jsx("span",{className:"text-sm font-semibold text-gray-800 dark:text-gray-100",children:(null==(h=null==B?void 0:B.database)?void 0:h.type)||"Unknown"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Status"}),a.jsx("span",{className:"text-sm font-semibold "+("ok"===(null==(u=null==B?void 0:B.database)?void 0:u.status)?"text-green-600":"text-red-600"),children:(null==(y=null==B?void 0:B.database)?void 0:y.status)||(M?"error":"unknown")})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Latency (ms)"}),a.jsx("span",{className:"text-sm font-semibold text-gray-800 dark:text-gray-100",children:(null==(b=null==B?void 0:B.database)?void 0:b.latencyMs)??"—"})]})]}),a.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-3 gap-3",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Cadets"}),a.jsx("span",{className:"text-sm font-semibold text-gray-800 dark:text-gray-100",children:(null==(f=null==B?void 0:B.metrics)?void 0:f.cadets)??"—"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Users"}),a.jsx("span",{className:"text-sm font-semibold text-gray-800 dark:text-gray-100",children:(null==(j=null==B?void 0:B.metrics)?void 0:j.users)??"—"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Training Days"}),a.jsx("span",{className:"text-sm font-semibold text-gray-800 dark:text-gray-100",children:(null==(k=null==B?void 0:B.metrics)?void 0:k.trainingDays)??"—"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Activities"}),a.jsx("span",{className:"text-sm font-semibold text-gray-800 dark:text-gray-100",children:(null==(v=null==B?void 0:B.metrics)?void 0:v.activities)??"—"})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Unread Notifications"}),a.jsx("span",{className:"text-sm font-semibold text-gray-800 dark:text-gray-100",children:(null==(N=null==B?void 0:B.metrics)?void 0:N.unreadNotifications)??"—"})]})]})]})})]}),a.jsx("div",{className:"pt-6 border-t border-gray-200",children:a.jsxs("button",{onClick:async()=>{z(!0);const e=await C(S);z(!1),e.success?x.success("Settings saved and applied successfully"):x.error(e.message||"Failed to save settings")},disabled:$,className:"flex items-center justify-center space-x-2 bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 transition-colors",children:[a.jsx(o,{size:20}),a.jsx("span",{children:$?"Saving...":"Save Settings"})]})})]})]})};export{g as default};
